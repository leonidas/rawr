(function(){var a;a=function(){function a(a,b,c){this.width=a,this.height=b,this.margin=c,this.chart=d3.select("body").append("svg:svg").attr("width",this.width).attr("height",this.height).style("font-family","Helvetica").style("font-size","11")}return a.prototype.draw=function(a,b){var c,d,e,f,g,h;return d=function(a){var b;return b=0,_(a).map(function(a){return a.start_x=b,b+=a.width})},c=function(a){var b;return b="",_(a).each(function(a){return b!==a.title?(a.display_text=a.title,b=a.title):a.display_text=""})},d(a),c(a),f=d3.sum(a,function(a){return a.width}),e=d3.max(a,function(a){return a.height}),g=d3.scale.linear().domain([0,f]).range([this.margin,this.width-this.margin]),h=d3.scale.linear().domain([0,e]).range([this.height-this.margin,this.margin]),this.drawXLabels(g),this.drawYLabels(h),this.drawDataRectangles(a,b,g,h),this.drawRectangleLabels(a,g)},a.prototype.drawXLabels=function(a){return this.chart.selectAll(".x-label").data(a.ticks(10)).enter().append("text").attr("class","x-label").attr("x",a).attr("y",this.height-this.margin+15).attr("text-anchor","middle").text(String)},a.prototype.drawYLabels=function(a){return this.chart.selectAll(".y-label").data(a.ticks(10)).enter().append("text").attr("class","y-label").attr("x",this.margin-5).attr("y",a).attr("text-anchor","end").attr("alignment-baseline","middle").text(String)},a.prototype.drawDataRectangles=function(a,b,c,d){return this.chart.selectAll("rect").data(a).enter().append("rect").attr("x",function(a){return c(a.start_x)}).attr("width",function(a){return c(a.start_x+a.width)-c(a.start_x)}).attr("y",function(a){return d(a.height)}).attr("height",function(a){return a.height>0?d(0)-d(a.height):3}).style("fill",function(a){return b[a.title]})},a.prototype.drawRectangleLabels=function(a,b){return this.chart.selectAll(".box-label").data(a).enter().append("g").attr("class","box-label").attr("transform",function(a){return"translate("+(b(a.start_x)+11)+","+(this.height-this.margin-3)+")"}).append("text").text(function(a){return a.display_text}).attr("transform","rotate(270)")},a}(),jQuery(function(){return d3.text("colors.csv",function(b){return console.log(b),d3.text("data.csv",function(c){var d,e,f,g,h,i;return console.log(c),e=_(d3.csv.parse(b)).reduce(function(a,b){return a[b.title]=b.color,a},{}),console.log(e),f=d3.csv.parse(c).map(function(a){return{title:a.title,width:parseFloat(a.width),height:parseFloat(a.height)}}),console.log(f),h=25,i=800,g=500,d=new a(i,g,h),d.draw(f,e)})})})}).call(this);