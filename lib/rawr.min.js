(function(){var a;a=function(){function a(a,b,c,d){this.width=b,this.height=c,this.margin=d,this.chart=a.append("svg:svg").attr("width",this.width).attr("height",this.height).style("font-family","Helvetica").style("font-size","11")}return a.prototype.draw=function(a,b){return this.calculateScale(a),this.drawXLabels(),this.drawYLabels(),this.drawDataRectangles(a,b),this.drawRectangleLabels(a)},a.prototype.calculateScale=function(a){var b,c;return c=d3.sum(a,function(a){return a.width}),b=d3.max(a,function(a){return a.height}),this.xScale=d3.scale.linear().domain([0,c]).range([this.margin,this.width-this.margin]),this.yScale=d3.scale.linear().domain([0,b]).range([this.height-this.margin,this.margin])},a.prototype.drawXLabels=function(){return this.chart.selectAll(".x-label").data(this.xScale.ticks(10)).enter().append("svg:text").attr("class","x-label").attr("x",this.xScale).attr("y",this.height-this.margin+15).attr("text-anchor","middle").text(String)},a.prototype.drawYLabels=function(){return this.chart.selectAll(".y-label").data(this.yScale.ticks(10)).enter().append("svg:text").attr("class","y-label").attr("x",this.margin-5).attr("y",this.yScale).attr("text-anchor","end").attr("alignment-baseline","middle").text(String)},a.prototype.drawDataRectangles=function(a,b,c){var d,e,f,g;return c==null&&(c="layer1"),d=function(a){var b;return b={},_(a).each(function(a){var c;return b[c=a.title]==null&&(b[c]=0),a.indexWithinGroup=b[a.title],b[a.title]+=1})},d(a),e=function(a){var b;return b=0,_(a).map(function(a){return a.start_x=b,b+=a.width})},e(a),f=this.xScale,g=this.yScale,console.log(a),this.rectG=this.chart.selectAll("."+c).data(a).enter().append("svg:g"),this.rectG.append("svg:rect").attr("class",c).attr("x",function(a){return f(a.start_x)}).attr("width",function(a){return f(a.start_x+a.width)-f(a.start_x)}).attr("y",function(a){return g(a.height)}).attr("height",function(a){return a.height>0?g(0)-g(a.height):3}).attr("style",function(a){return b[a.title]})},a.prototype.drawRectangleLabels=function(a){var b,c;return c=this.xScale,b=this.height-this.margin-3,this.rectG.append("svg:g").attr("class","box-label").attr("transform",function(a){return"translate("+(c(a.start_x)+11)+","+b+")"}).append("svg:text").text(function(a){if(a.indexWithinGroup===0)return a.title}).attr("transform","rotate(270)")},a}(),window.Chart=a}).call(this);